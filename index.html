<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vibe-Check Final</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<style>
:root { 
    --bg-soft: #f8fafc; 
    --text-dark: #334155; 
    --pastel-salmon: #FF9F8A; 
    --pastel-blue: #A7C7E7; 
    --glass-bg: rgba(255, 255, 255, 0.75); 
}

body {
    font-family: 'Inter', sans-serif;
    background-color: #e2e8f0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    color: var(--text-dark);
}

.app-container {
    background-color: var(--bg-soft);
    width: 100%;
    max-width: 400px;
    height: 100vh;
    max-height: 850px;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.top-bar {
    padding: 40px 24px 15px 24px;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(20px);
}

h1 {
    font-size: 1.6rem;
    margin: 0 0 15px 0;
    font-weight: 800;
    background: linear-gradient(135deg, var(--pastel-salmon), var(--pastel-blue));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.search-box {
    background: #f1f5f9;
    border-radius: 16px;
    display: flex;
    align-items: center;
    padding: 0 16px;
    height: 46px;
}

.search-input {
    border: none;
    background: transparent;
    width: 100%;
    outline: none;
    font-size: 0.9rem;
    margin-left: 10px;
}

.feed-container {
    flex: 1;
    overflow-y: auto;
    padding: 20px 24px 120px 24px;
}

.feed-card {
    background: var(--glass-bg);
    backdrop-filter: blur(24px);
    border-radius: 24px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
}

.place-name {
    font-weight: 800;
    font-size: 1.1rem;
    margin-bottom: 8px;
}

.review-text {
    font-size: 0.95rem;
    margin-bottom: 12px;
}

.tag-list {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.tag {
    font-size: 0.75rem;
    background: white;
    padding: 6px 12px;
    border-radius: 10px;
    font-weight: 600;
}

.tag.highlight {
    background: rgba(167, 199, 231, 0.2);
    color: #478ecc;
}
</style>
</head>
<body>

<div class="app-container">
    <div class="top-bar">
        <h1>Vibe-Check ‚ú®</h1>
        <div class="search-box">
            üîç
            <input type="text" id="searchInput" class="search-input"
                   placeholder="Stadt suchen..."
                   onkeypress="handleSearch(event)">
        </div>
    </div>

    <div class="feed-container" id="feedContainer">
        <p style="text-align:center;color:#94a3b8;">
            Suche eine Stadt‚Ä¶
        </p>
    </div>
</div>

<script>
const API_KEY = "DEIN_API_KEY_HIER"; // <-- ERSETZEN

function handleSearch(event) {
    if (event.key === 'Enter') {
        const city = document.getElementById('searchInput').value;
        if (city.trim() !== "") {
            fetchVibes(city);
        }
    }
}

async function fetchVibes(q) {
    const feed = document.getElementById('feedContainer');
    feed.innerHTML = `<p style="text-align:center;padding-top:40px;">Lade Vibes f√ºr ${q}...</p>`;

    try {
        const response = await fetch(
            `https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash-latest:generateContent?key=${API_KEY}`,
            {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [
                        {
                            role: "user",
                            parts: [{
                                text: `Gib mir 3 echte coole Caf√©s in ${q}.
                                Antworte ausschlie√ülich als JSON Array:
                                [
                                  {
                                    "place":"Name",
                                    "review":"Kurze Beschreibung",
                                    "highlight":"‚òÅÔ∏è Cozy",
                                    "tags":["Tag1","Tag2"]
                                  }
                                ]`
                            }]
                        }
                    ]
                })
            }
        );

        const data = await response.json();

        if (!data.candidates) {
            throw new Error(JSON.stringify(data));
        }

        let text = data.candidates[0].content.parts[0].text
            .replace(/```json/g, '')
            .replace(/```/g, '')
            .trim();

        let spots;

        try {
            spots = JSON.parse(text);
        } catch {
            const match = text.match(/\[.*\]/s);
            if (!match) throw new Error("Ung√ºltiges JSON erhalten");
            spots = JSON.parse(match[0]);
        }

        feed.innerHTML = "";

        spots.forEach(s => {
            feed.innerHTML += `
                <div class="feed-card">
                    <div class="place-name">${s.place}</div>
                    <div class="review-text">${s.review}</div>
                    <div class="tag-list">
                        <span class="tag highlight">${s.highlight}</span>
                        ${(s.tags || []).map(t => `<span class="tag">${t}</span>`).join('')}
                    </div>
                </div>
            `;
        });

    } catch (error) {
        console.error(error);
        feed.innerHTML = `
            <div style="padding:20px;color:red;">
                API Fehler:<br>${error.message}
            </div>
        `;
    }
}
</script>

</body>
</html>
